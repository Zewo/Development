os:
  - osx
language: generic
sudo: required
osx_image: xcode8
install:
  - eval "$(curl -sL https://raw.githubusercontent.com/QuarkX/Quark/master/swiftenv-install.sh)"
script:
  - swift build
  - swift build --configuration release
  - swift package generate-xcodeproj
  - set -o pipefail
  - export WORKING_DIRECTORY=$(PWD)
  - export TOOLCHAINS=org.swift.3020160620a
  - xcodebuild ONLY_ACTIVE_ARCH=NO ENABLE_TESTABILITY=YES -project Quark.xcodeproj -scheme Quark -sdk macosx10.12 -destination arch=x86_64 -configuration Debug -enableCodeCoverage YES test
after_success:
  - bash <(curl -s https://codecov.io/bash)
